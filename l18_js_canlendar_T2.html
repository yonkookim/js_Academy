<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" href="../css/l17_calendar.css">
    <title>js calendar</title>
  </head>
  <body>
  <h1>(일정 등록되는)달력 만들기</h1>
    <h2>
       <button class="changeMonth" id="preMonth" type="button" value="2021-8">2021년 8월</button>
       <span id="toDate">
         2021년
         9월
       </span>
       <form name="changeDate">
        <label>year:
           <input type="number" name="" value="2030">
        </label>
        <label>month:
          <!-- <input type="number" name="" value="10" max="12" min="1"> -->
          <select name="changeYear">
            <!-- option[value="$$"]{$$월}*12 -->
            option[value="$$"]{$$월}*12
            <option value="1">1월</option>
            <option value="2">2월</option>
            <option value="3">3월</option>
            <option value="4">4월</option>
            <option value="5" selected>5월</option>
            <option value="6">6월</option>
            <option value="7">7월</option>
            <option value="8">8월</option>
            <option value="9">9월</option>
            <option value="10">10월</option>
            <option value="11">11월</option>
            <option value="12">12월</option>
          </select>
        </label>


       </form>
       <button class="changeMonth" id="nextMonth" type="button" value="2021-10">2021년 10월</button>
     </h2>
    <table id="calendarTable">
      <thead>
        <tr>
          <th>일</th>
          <th>월</th>
          <th>화</th>
          <th>수</th>
          <th>목</th>
          <th>금</th>
          <th>토</th>
        </tr>
      </thead>
      <tbody>
        <tr>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
        </tr>
        <tr>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
          <td>
            <div class="day_container">
              <h5 class="day"></h5>
              <ul class="schedule">
                <li></li>
                <li></li>
                <li></li>
                <li></li>
                <li></li>
              </ul>
            </div>
          </td>
        </tr>
      </tbody>
    </table>
  </body>
  <script>
const tdList= document.querySelectorAll("#calendarTable td");
for(td of tdList){
  td.onmouseenter=(event)=>{
    event.target.querySelector(".schedule").style.visibility="visible";
  }
  td.addEventListener("mouseleave",function(event){
    event.target.querySelector(".schedule").style.visibility="hidden";
  })
}
//new Date().getMonth() 현재 달의 -1을 반환한다.(0~11)
printCalendar(new Date().getMonth()+1);

function printCalendar(paraMonth,paraYear=(new Date().getYear()+1900)){
  let dateMonth=paraMonth-1; //Date()는 month 가 0~11까지다.
  //9월 마지막 일 구하기
  let lastDay=new Date(paraYear,dateMonth+1,0).getDate();
  //9월의 시작하는 요일 구하기
  let firstDay=new Date(paraYear,dateMonth,1).getDay();
  //전달의 마지막날 구하기
  let lastMonth=new Date(paraYear,dateMonth,0).getDate();
  //////////////////////////////////////////////////////////////////////


  function ButtonValue(month,year){
    this.month=month;
    this.year=year;
    this.text=`${this.year}년도 ${this.month}월`;
    this.value=`${this.year}-${this.month}`;
  }
  const nextB=(paraMonth+1==13)
                ?new ButtonValue(1,paraYear+1)
                :new ButtonValue(paraMonth+1,paraYear);

  const preB=(paraMonth-1==0)
                ?new ButtonValue(12,paraYear-1)
                :new ButtonValue(paraMonth-1,paraYear);

  document.getElementById("nextMonth").innerText=nextB.text;
  document.getElementById("nextMonth").value=nextB.value;

  document.getElementById("preMonth").innerText=preB.text;
  document.getElementById("preMonth").value=preB.value;

  document.getElementById("toDate").innerText=`${paraYear}. ${paraMonth}`;
  //document.getElementById("toDate").innerText=new Date(paraYear,dateMonth);



  //활성화된 해당 월 출력
  for(let i=firstDay,d=1; i<lastDay+firstDay; i++){
    tdList[i].querySelector(".day").innerText=d++;
    tdList[i].classList.add("active"); //활성화된 td 스타일 추가
    tdList[i].classList.remove("disabled"); //비활성화된 td 스타일 삭제

  }

  //비활성화된 전달의 출력
  for(let i=firstDay-1; i>=0; i--){
    tdList[i].querySelector(".day").innerText=lastMonth--;
    tdList[i].classList.add("disabled");//비활성화된 td 스타일 추가
    tdList[i].classList.remove("active");//활성화된 td 스타일 삭제

  }
  //비활성화된 다음달 출력
  let nextMonth=firstDay+lastDay
  for(let i=nextMonth,num=1; i<=tdList.length-1; i++){
    tdList[i].querySelector(".day").innerText=num++;
    tdList[i].classList.add("disabled");//비활성화된 td 스타일 추가
    tdList[i].classList.remove("active");//활성화된 td 스타일 삭제

  }
}
//button인 달 바꾸기만 onclick이벤트 재정의
document.querySelectorAll(".changeMonth[type=button]").forEach((item) => {
//  item.onclick=function(){}
    item.addEventListener("click",(event)=>{
      let yearMonthArr=event.target.value.split("-");//"2021-8"->[2021,8]
      printCalendar(Number(yearMonthArr[1]),Number(yearMonthArr[0]));
    });
});

</script>
</html>
